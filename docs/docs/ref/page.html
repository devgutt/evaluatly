<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="/evaluatly/css/docs.css">
    <title>Page - Evaluatly Docs</title>
</head>
<body>
    <div class="root">
        <div class="main">
            <div>
                <div class="menu">
	<div class="header">
		<a href="/evaluatly/docs"><img src="/evaluatly/static/img/evaluatly-logo-96x46.png"/></a>
		<div class="middle"><span>Docs</span></div>
		<div>
			<a href="#" class="hamburger" id="menu-ham">
				<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#1A202C" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
					<line x1="21" y1="10" x2="3" y2="10"></line><line x1="21" y1="6" x2="3" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="21" y1="18" x2="3" y2="18"></line>
				</svg>
			</a>
		</div>
	</div>
	<ul class="nav" id="menu-list" style="display: none">
				<li class="">
			<a href="/evaluatly/docs">Getting Started</a>
								</li>
				<li class="">
			<a href="/evaluatly/docs/ref">Reference</a>
									<ul>
								<li class="">
					<a href="/evaluatly/docs/ref/root.html">Root</a>
									</li>
								<li class="">
					<a href="/evaluatly/docs/ref/story.html">Story</a>
									</li>
								<li class="active">
					<a href="/evaluatly/docs/ref/page.html">Page</a>
											<div class="onpage mob-hide">
	<ul>
<li><a href="#submit">Submitting forms</a></li>
<li><a href="#payments">Payments</a></li>
</ul>
</div>

			
	
									</li>
								<li class="">
					<a href="/evaluatly/docs/ref/items.html">Items</a>
									</li>
								<li class="">
					<a href="/evaluatly/docs/ref/commands.html">Commands</a>
									</li>
								<li class="">
					<a href="/evaluatly/docs/ref/text.html">Text</a>
									</li>
								<li class="">
					<a href="/evaluatly/docs/ref/theme.html">Theme</a>
									</li>
								</ul>
					</li>
				<li class="">
			<a href="https://github.com/devgutt/evaluatly-js">GitHub</a>
								</li>
			</ul>
</div>
	
                <div class="content">
                    <div class="body">
                        <h1>Page</h1>
                                                <div class="topics index">
                            <h5>Index</h5>
                            <ul>
<li><a href="#submit">Submitting forms</a></li>
<li><a href="#payments">Payments</a></li>
</ul>
                        </div>
                            
                        <p>A story page that contains the <a href="/evaluatly/docs/ref/items.html">items</a> to be displayed.</p>
<h3>Attributes</h3>
<p><strong><code>page_id</code></strong>  <em>optional</em>   </p>
<p>The unique identifier of the page.</p>
<p><strong><code>style</code></strong> <em>optional</em></p>
<p>Style to be applied to the whole page as CSS key-value pairs. </p>
<p>The values can be a literal value or a single <a href="/evaluatly/docs/ref/commands.html">command</a> call returning a literal value.</p>
<p><strong><code>style_content</code></strong> <em>optional</em></p>
<p>Style to be applied to the page content as CSS key-value pairs. </p>
<p>The values can be a literal value or a single <a href="/evaluatly/docs/ref/commands.html">command</a> call returning a literal value.</p>
<p><strong><code>items</code></strong>   </p>
<p>List of the <a href="/evaluatly/docs/ref/items.html">items</a> of the page.</p>
<p><strong><code>submit</code></strong>  <em>optional</em>   </p>
<p>Options for submitting forms. See more in <a href="#submit">Submitting forms</a> bellow.</p>
<p><strong><code>history</code></strong>  <em>optional</em>     </p>
<p>Indicates whether to add the page to the backlist.</p>
<p>Values: <code>true</code> (default) or <code>false</code></p>
<h4><code>env</code></h4>
<p>Environment attributes:</p>
<p><strong><code>show_back</code></strong>  <em>optional</em></p>
<p>Indicates whether or not to show the back button on the page.</p>
<p>Values: <code>true</code> (default) or <code>false</code></p>
<p><strong><code>show_logo</code></strong>  <em>optional</em></p>
<p>Indicates whether or not to show the logo image, if it exists.</p>
<p>Values: <code>true</code> (default) or <code>false</code></p>
<h4><code>progress</code> <em>optional</em></h4>
<p>Progress bar attributes:</p>
<p><strong><code>show</code></strong> </p>
<p>Indicates whether or not to show the progress bar on the page. Defaults to the <code>story.progress.show</code>.</p>
<p><strong><code>value</code></strong> <em>optional</em></p>
<p>Percentage number of progress, from 0 to 100. Defaults to the progress of the page.</p>
<p><strong><code>style</code></strong> <em>optional</em></p>
<p>Style to be applied to the progress bar as CSS key-value pairs. </p>
<p>The values can be a literal value or a single <a href="/evaluatly/docs/ref/commands.html">command</a> call returning a literal value.</p>
<h3>Example</h3>
<pre><code class="language-JSON"> {
    "page_id": "page_start",
    "style": {
        "background_color": "#DAFFEF",
        "align": "center"
    },
    "progress": {
        "show": true,
        "value": 33
    },
    "items": [
        { "type": "title", "value": "The Story" },
        { "type": "p", "value": "This is the story of a boy..." },
        { "type": "button", "label": "Next", "program": {"next_page": true} }
    ]
}</code></pre>
<h2 class="group"><a href="#submit" id="submit">#</a> Submitting forms</h2>
<p>Process and save form information to variables.</p>
<blockquote>
<p>Tip: To send information to the server, use the <a href="/evaluatly/docs/ref/commands.html#call"><code>call</code></a> command.</p>
</blockquote>
<h4>Attributes</h4>
<p><strong><code>program</code></strong>   </p>
<p>One or more <a href="/evaluatly/docs/ref/commands.html">commands</a> to execute, after processing and saving the variables.</p>
<p><strong><code>label</code></strong>   </p>
<p>Submission button label.</p>
<p><strong><code>input_submit</code></strong>  <em>optional</em></p>
<p>Transfers the form submission to the input elements. Defaults to <code>false</code>.</p>
<blockquote>
<p>For single-input forms, set this option to <code>true</code> to highlight the input and transfer the submission to the element. âœ¨</p>
</blockquote>
<p><strong><code>payment</code></strong>  <em>optional</em></p>
<p>Information to create a checkout page to receive payments. Check the <a href="#payments">Payments</a> section below for more details.</p>
<h4>Examples</h4>
<p>Page with multiple input elements:</p>
<pre><code class="language-JSON">{
    "items": [
        { "type": "title", "value": "Contact Us" },
        { "type": "name", "label": "Name", "save_key": "name", "required": true },
        { "type": "email", "label": "Email", "save_key": "email", "required": true },
        { "type": "textlong", "save_key": "msg", "label": "Message", "required": true }
    ],
    "submit" : {
        "label": "Send Message",
        "program":  [
            {"next_page": true}
        ]
    } 
}</code></pre>
<p>Page with a single input element using <code>input_submit</code>:</p>
<pre><code class="language-JSON">{
    "items": [
        { "type": "question", "value": "What's your name?" },
        { "type": "name", "save_key": "name", "required": true}
    ],
    "submit" : { 
        "label": "Next", 
        "input_submit": true,
        "program": [ {"next_page": true} ] 
    }  
}</code></pre>
<hr />
<h2 class="group"><a href="#payments" id="payments">#</a> Payments</h2>
<p>This section explains how to create a checkout page to receive payments with credit and debit cards.</p>
<blockquote>
<p>The payment is processed using <a href="https://stripe.com" target="_blank">Stripe</a>.</p>
</blockquote>
<h4>Attributes</h4>
<p><strong><code>pk</code></strong>   </p>
<p>The <em>publishable key</em> provided by Stripe to receive payments. </p>
<blockquote>
<p>If you don't have a Stripe account yet, create one on their <a href="https://stripe.com" target="_blank">website</a>.</p>
</blockquote>
<p><strong><code>endpoint</code></strong>   </p>
<p>The URL to be called to fetch the payment information. The URL can be an absolute or relative path.</p>
<p><strong><code>save_key</code></strong>  <em>optional</em></p>
<p>Key to save the payment information in the data table. Defaults to &quot;<code>payment_ok</code>&quot;.</p>
<p><strong><code>required</code></strong>  <em>optional</em></p>
<p>Indicates whether the payment is required. The default is <code>true</code>.</p>
<p><strong><code>data</code></strong> </p>
<p>Keys of the variables containing the buyer's information to be submitted with the payment:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>name</code></td>
<td style="text-align: left;">Key of the variable containing the name of the buyer.</td>
</tr>
<tr>
<td style="text-align: left;"><code>email</code></td>
<td style="text-align: left;">Key of the variable containing the email of the buyer.</td>
</tr>
<tr>
<td style="text-align: left;"><code>receipt_email</code></td>
<td style="text-align: left;">Key of the variable containing the email that will be used by Stripe to send the receipt for the buyer. See more about email receipts at <a href="https://stripe.com/evaluatly/docs/receipts" target="_blank">Stripe</a>.</td>
</tr>
</tbody>
</table>
<h4>Example</h4>
<pre><code class="language-JSON">{
    "items": [
        { "type": "title", "value": "Payment" },
        { "type": "name", "label": "Name", "save_key": "name_buyer", "autoFocus": true, "required": true},
        { "type": "email", "label": "Email", "save_key": "email_buyer", "required": true},
        { "type": "p", "value": "Your credit card will be charged **$45**" },
        { "type": "card" }
    ],
    "submit": {
        "label": "Buy",
        "program": {"next_page" : true},
        "payment": {
            "pk": "&lt; YOUR PUBLISHABLE KEY &gt;",
            "endpoint": "/api/endpoint/payment",
            "data": {
                "name": "name_buyer",
                "email": "email_buyer",
                "receipt_email": "email_buyer"
            }
        }
    }
}</code></pre>
<p>Check the payment <a href="/demo/payment">demo</a>.</p>
<h4><a href="#pay-server" id="pay-server"></a> Server processing</h4>
<p>To complete the payment you need to create a <code>secret</code> token on the server-side to secure and validate the transaction.</p>
<p><strong> Request </strong></p>
<p>A <strong><code>POST</code></strong> request will be called on the URL endpoint, using the <code>endpoint</code> attribute.</p>
<p>The following parameters will be sent in the <strong><code>BODY</code></strong> of the request:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>origin</code></td>
<td style="text-align: left;">The protocol, hostname, and port number of the caller's URL.</td>
</tr>
</tbody>
</table>
<p><strong> Response </strong></p>
<p>The server must respond with a JSON message containing the following parameters:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>ok</code></td>
<td style="text-align: left;"><code>true</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>res.secret</code></td>
<td style="text-align: left;">Token used to complete the payment.</td>
</tr>
<tr>
<td style="text-align: left;"><code>res.title</code></td>
<td style="text-align: left;">Title of the item.</td>
</tr>
</tbody>
</table>
<blockquote>
<p>The <code>secret</code> is created using the <em>secret key</em> associated with the <em>publishable key</em> provided by Stripe.
For more information on how to create the secret, consult the
<a href="https://stripe.com/evaluatly/docs/payments/accept-a-payment#web-create-payment-intent" target="_blank">Stripe documentation</a>.</p>
</blockquote>
<p>if an <strong>error</strong> occurs:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>ok</code></td>
<td style="text-align: left;"><code>false</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>error_msg</code></td>
<td style="text-align: left;">The error message to be shown to the user.</td>
</tr>
<tr>
<td style="text-align: left;"><code>error_code</code></td>
<td style="text-align: left;">The error code.</td>
</tr>
</tbody>
</table>
<p>Example of response:</p>
<pre><code class="language-JSON">{
    "ok": true,
    "res": {"secret": "** secret generated **", "title": "Item 1"}
}</code></pre>
<p>An error response:</p>
<pre><code class="language-JSON">{   
    "ok": false,
    "error_msg": "Invalid request",
    "error_code": "ERROR_INVALID_REQUEST"
}</code></pre>
<h4>Payment successfull</h4>
<p>After the payment is accepted, a variable with the key informed on <strong><code>save_key</code></strong> attribute is created on the data table.</p>
<p>The following properties are saved on the variable:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Property</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>id</code></td>
<td style="text-align: left;">The payment id provided by Stripe.</td>
</tr>
<tr>
<td style="text-align: left;"><code>amount</code></td>
<td style="text-align: left;">The amount of the payment.</td>
</tr>
<tr>
<td style="text-align: left;"><code>currency</code></td>
<td style="text-align: left;">The currency of the payment.</td>
</tr>
<tr>
<td style="text-align: left;"><code>title</code></td>
<td style="text-align: left;">The title of the item.</td>
</tr>
</tbody>
</table>
<p>These variables can be retrieved using <a href="/evaluatly/docs/ref/commands.html#data">Data commands</a>.</p>
<p>Example:</p>
<pre><code class="language-JSON">{ "type": "p", "value": "The item {{payment_ok.title}} was purchased. Payment ID: {{payment_ok.id}}" }</code></pre>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <script src="/evaluatly/js/docs.js"></script>
    <script src="/evaluatly/static/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</body>
</html>

